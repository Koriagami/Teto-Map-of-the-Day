# Nixpacks configuration for Railway deployment
# Ensures canvas (node-canvas) system dependencies are installed

providers = ["node"]

[phases.setup]
nixPkgs = [
  "pkgs.nodejs",
  "pkgs.python311",
  "pkgs.gcc",
  "pkgs.glibc",
  "pkgs.pkg-config",
  "pkgs.cairo",
  "pkgs.pango",
  "pkgs.glib",
  "pkgs.libpng",
  "pkgs.libjpeg",
  "pkgs.giflib",
  "pkgs.librsvg"
]

[phases.install]
cmds = [
  "npm ci"
]

[phases.build]
cmds = [
  "npm run db:generate"
]

[start]
cmd = "npm start"
